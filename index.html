<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<link rel="stylesheet" href="./css/styles.css" />
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
			integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
			crossorigin="anonymous"
		/>
		<link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
		/>
	</head>
	<body>
		<main>
			<div class="p-3">
				<h1>Custom Calendar</h1>
			</div>

			<div class="calendar__container">
				<div class="calendar__actions">
					<div class="calendar__actions-switch-view">
						Mostrar
						<select name="" id="">
							<option value="0">Valor 1</option>
							<option value="1">Valor 2</option>
							<option value="2">Valor 3</option>
						</select>
					</div>
					<div class="calendar__actions-date-view">
						<p class="m-0" id="calendar-text">1 Ene 21 - 31 Ene 21</p>
					</div>
					<div class="calendar__actions-switch-date">
						<span id="btnLeft"><i class="fa fa-chevron-left"></i></span>
						<span id="btnCurrent">Hoy</span>
						<span id="btnRight"><i class="fa fa-chevron-right"></i></span>
					</div>
				</div>

				<div class="calendar">
					<div class="calendar__container-header">
						<div class="calendar__container-item-1">
							<span>Tipo</span>
						</div>
						<div class="calendar__container-item-2">
							<span>Numero</span>
						</div>
						<div class="calendar__date-container">
							<div class="calendar__date-title" id="calendar-monthTitle">ENE</div>
							<div class="calendar__date-dates" id="calendar__days"></div>
						</div>
					</div>

					<div class="calendar__container-body">
						<div class="calendar__container-item-1">
							<span>Presidencial</span>
						</div>
						<div class="calendar__container-item-2">
							<span>200</span>
						</div>
						<div class="calendar__bookings-items">
							<div class="calendar__date-dates booking-days"></div>
						</div>

						<div class="calendar__container-item-1">
							<span>Presidencial</span>
						</div>
						<div class="calendar__container-item-2">
							<span>201</span>
						</div>
						<div class="calendar__bookings-items">
							<div class="calendar__date-dates booking-days"></div>
						</div>

						<div class="calendar__container-item-1">
							<span>Sencilla</span>
						</div>
						<div class="calendar__container-item-2">
							<span>100</span>
						</div>
						<div class="calendar__bookings-items">
							<div class="calendar__date-dates booking-days"></div>
						</div>

						<div class="calendar__container-item-1">
							<span>Sencilla</span>
						</div>
						<div class="calendar__container-item-2">
							<span>101</span>
						</div>
						<div class="calendar__bookings-items">
							<div class="calendar__date-dates booking-days"></div>
						</div>
					</div>
				</div>
			</div>
		</main>

		<script
			src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
			integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
			integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
			integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
			crossorigin="anonymous"
		></script>
		<!-- <script src="js/moment.min.js"></script> -->
		<script src="js/moment-locale.js"></script>

		<script>
			$(function () {
				$('[data-toggle="tooltip"]').tooltip();
			});

			const data = [
				{
					type: 'Presidencial',
					code: 200,
					folio: '0001',
					group: 'YUCA-200',
					booking: [
						{
							checkIn: '2020-01-30',
							checkOut: '2020-01-31',
						},
					],
				},
			];

			console.log(data);

			moment.locale('es');

			let cMonth = new Date().getMonth();
			const cDay = moment().format('D');

			const afterMonth = () => {
				cMonth--;

				printDays(cMonth);
			};

			const nextMonth = () => {
				cMonth++;

				printDays(cMonth);
			};

			const currentMonth = () => {
				cMonth = new Date().getMonth();

				printDays(cMonth);
			};

			const printDays = (month) => {
				const ttlDays = moment().endOf('month').add(month, 'month').format('DD');
				const eDays = document.querySelector('#calendar__days');
				const cMonth = new Date().getMonth();

				eDays.innerHTML = '';

				for (let i = 0; i < ttlDays; i++) {
					const eSpan = document.createElement('span');
					eSpan.innerHTML = `${i + 1}`;

					if (i + 1 === Number(cDay) && Number(month) === cMonth) {
						eSpan.className = 'current-day';
					}

					eDays.appendChild(eSpan);
				}

				printTxtDate(ttlDays, month);
				printBookings(ttlDays, month);
			};

			const printTxtDate = (ttlDays, month) => {
				const eTextDate = document.getElementById('calendar-text');
				const eMonthTitle = document.getElementById('calendar-monthTitle');
				const txtMonth = moment().add(month, 'month').format('MMMM');
				const txtYear = moment().add(month, 'month').format('YYYY');

				eTextDate.innerText = `1 ${txtMonth} ${txtYear} - ${ttlDays} ${txtMonth} ${txtYear}`;
				eMonthTitle.innerText = `${txtMonth.toUpperCase()}`;
			};

			const printBookings = (days, month) => {
				const eDaysBooking = document.querySelectorAll('.booking-days');
				const cMonth = new Date().getMonth();

				setStyGridTempCol(days);

				eDaysBooking.forEach((e) => {
					e.innerHTML = '';

					for (let i = 0; i < days; i++) {
						const eDiv = document.createElement('div');

						if (i + 1 === Number(cDay) && cMonth === month) {
							eDiv.className = 'current-day';
						}

						e.appendChild(eDiv);
					}
				});
			};

			const setStyGridTempCol = (days) => {
				const eGrid = document.querySelectorAll('.calendar__date-dates');

				eGrid.forEach((e) => {
					e.style.gridTemplateColumns = 'repeat(' + days + ', 1fr)';
				});
			};

			printDays(cMonth);

			const btnRight = document.querySelector('#btnRight');
			const btnLeft = document.querySelector('#btnLeft');
			const btnCurrent = document.querySelector('#btnCurrent');

			btnRight.addEventListener('click', nextMonth);
			btnLeft.addEventListener('click', afterMonth);
			btnCurrent.addEventListener('click', currentMonth);
		</script>
	</body>
</html>
